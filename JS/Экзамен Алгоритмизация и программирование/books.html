<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Книги</title>

    <style>
        * {
            padding: 0px;
            margin: 0px;
            box-sizing: border-box;
        }

        body {
            display: flex;
            flex-direction: column;
            align-items: center;
        }

        main {
            display: flex;
            flex-direction: column;
            align-items: center;
        }

        body div {
            display: flex;
            flex-wrap: wrap;
            justify-content: space-between;
            margin: 0 5%;
         
        }

        body div>div {
            width: 30%;
            display: flex;
            flex-wrap: wrap;
            flex-direction: column;
            margin: 1% 1%;
            border: 2px solid black;
            background-color: bisque;
            align-items: center;
        }

        body div>div>p:nth-child(-n+2) {
            font-weight: bold;
            font-size: 150%;
        }

        body div>div>p:nth-child(even), body div>div>button {
            margin-bottom: 5%;
        }

        input {
            margin: 3% 0;
            width: 20%;
        }
    </style>
</head>

<body>
    <script>
        let body = document.querySelector("body");
        let main = document.createElement("main");
        let contentDiv = document.createElement("div");

        let input = document.createElement("input");
        input.type = "text";
        input.name = "q";
        input.placeholder = "Поиск...";
        input.addEventListener("input", filterBooks);

        let bookDiv = document.createElement("div");
        let author = document.createElement("p");
        let country = document.createElement("p");
        let language = document.createElement("p");
        let pages = document.createElement("p");
        let title = document.createElement("p");
        let year = document.createElement("p");
        let button = document.createElement("button");
        button.textContent = "Подробнее";

        let contentArray = [author, title, country, language, pages, year, button];
        contentArray.forEach(item => { bookDiv.append(item) });

        body.appendChild(main);
        main.append(input);
        main.append(contentDiv);

        //1.receive content from JSON 
        fetch('books.json')
            .then(response => response.json())
            .then(books => {
                //2.insert data into html blocks
                books.forEach(book => {
                    author.textContent = book.author;
                    country.textContent = `Страна: ${book.country}`;
                    language.textContent = `Язык: ${book.language}`;
                    pages.textContent = `Страниц: ${book.pages}`;
                    title.textContent = book.title;
                    year.textContent = `Написана в: ${book.year} году`;

                    let newDiv = bookDiv.cloneNode(true);
                    contentDiv.append(newDiv);
                });
            });

        function filterBooks(event) {
            main.lastChild.childNodes.forEach(div => {
                let matchIsFound = false;

                div.childNodes.forEach(child => {
                    if (child.textContent.toLowerCase().includes(event.target.value.toLowerCase())) {
                        matchIsFound = true;
                    }
                });
                div.style.display = matchIsFound ? "flex" : "none"
            });
        };
    </script>
</body>

</html>